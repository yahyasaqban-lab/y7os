#!/bin/bash
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#  Y7 OS â€” AI Stack Installer v0.1
#  github.com/yahyasaqban-lab/y7os
#  MIT License â€” free forever, for everyone
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

set -e  # exit on any error

# â”€â”€ Colors â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
CYAN='\033[0;36m'
BOLD='\033[1m'
NC='\033[0m' # No Color

# â”€â”€ Banner â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
print_banner() {
  echo ""
  echo -e "${BLUE}${BOLD}"
  echo "  â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—"
  echo "  â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â•šâ•â•â•â•â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•”â•â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â•"
  echo "   â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•     â–ˆâ–ˆâ•”â•    â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—"
  echo "    â•šâ–ˆâ–ˆâ•”â•     â–ˆâ–ˆâ•”â•     â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â•šâ•â•â•â•â–ˆâ–ˆâ•‘"
  echo "     â–ˆâ–ˆâ•‘      â–ˆâ–ˆâ•‘      â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘"
  echo "     â•šâ•â•      â•šâ•â•       â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•"
  echo -e "${NC}"
  echo -e "${CYAN}  The AI-first Linux distro for low-resource hardware${NC}"
  echo -e "${CYAN}  ØªÙˆØ²ÙŠØ¹Ø© Ù„ÙŠÙ†ÙƒØ³ Ù…Ø®ØµØµØ© Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ${NC}"
  echo ""
  echo -e "  ${BLUE}github.com/yahyasaqban-lab/y7os${NC}"
  echo "  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€"
  echo ""
}

# â”€â”€ Logging â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
log_ok()   { echo -e "  ${GREEN}âœ…${NC}  $1"; }
log_info() { echo -e "  ${CYAN}â„¹ï¸ ${NC}  $1"; }
log_warn() { echo -e "  ${YELLOW}âš ï¸ ${NC}  $1"; }
log_err()  { echo -e "  ${RED}âŒ${NC}  $1"; }
log_step() { echo ""; echo -e "  ${BOLD}${BLUE}â–¶ $1${NC}"; echo ""; }

# â”€â”€ Hardware Detection â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
detect_hardware() {
  log_step "Detecting hardware..."

  # Architecture
  ARCH=$(uname -m)
  log_info "Architecture: $ARCH"

  # CPU info
  CPU_MODEL=$(grep -m1 'model name' /proc/cpuinfo | cut -d: -f2 | xargs)
  CPU_CORES=$(nproc)
  log_info "CPU: $CPU_MODEL ($CPU_CORES cores)"

  # RAM
  TOTAL_RAM_MB=$(free -m | awk '/^Mem:/{print $2}')
  FREE_RAM_MB=$(free -m | awk '/^Mem:/{print $7}')
  log_info "RAM: ${TOTAL_RAM_MB}MB total, ${FREE_RAM_MB}MB free"

  # Disk
  FREE_DISK_GB=$(df -BG / | awk 'NR==2{print $4}' | tr -d 'G')
  log_info "Free disk: ${FREE_DISK_GB}GB"

  # Check AVX2 support (for optimized llama.cpp)
  if grep -q avx2 /proc/cpuinfo; then
    AVX2_SUPPORT=true
    log_info "AVX2: âœ… Supported (optimized inference)"
  else
    AVX2_SUPPORT=false
    log_warn "AVX2: Not supported (will use generic build)"
  fi

  # OS Detection
  if [ -f /etc/os-release ]; then
    . /etc/os-release
    OS_NAME="$NAME"
    OS_VERSION="$VERSION_ID"
    log_info "OS: $OS_NAME $OS_VERSION"
  else
    log_warn "Could not detect OS version"
    OS_NAME="Unknown"
  fi

  # Recommend model based on RAM
  if [ "$TOTAL_RAM_MB" -gt 15000 ]; then
    RECOMMENDED_MODEL="mistral:7b-q4_k_m"
    RECOMMENDED_LABEL="Mistral 7B Q4 (best quality)"
  elif [ "$TOTAL_RAM_MB" -gt 5000 ]; then
    RECOMMENDED_MODEL="phi3:mini"
    RECOMMENDED_LABEL="Phi-3 Mini (best quality/size ratio)"
  elif [ "$TOTAL_RAM_MB" -gt 3000 ]; then
    RECOMMENDED_MODEL="gemma:2b"
    RECOMMENDED_LABEL="Gemma 2B (fast, efficient)"
  else
    RECOMMENDED_MODEL="tinyllama"
    RECOMMENDED_LABEL="TinyLlama (ultra-low RAM)"
  fi

  log_info "Recommended model: $RECOMMENDED_LABEL"
}

# â”€â”€ Preflight Checks â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
preflight_checks() {
  log_step "Running preflight checks..."

  # Must be Linux
  if [ "$(uname)" != "Linux" ]; then
    log_err "Y7 OS installer requires Linux."
    exit 1
  fi

  # Must not be root for safety
  if [ "$EUID" -eq 0 ]; then
    log_warn "Running as root. This is allowed but not recommended."
  fi

  # Check minimum RAM
  if [ "$TOTAL_RAM_MB" -lt 2000 ]; then
    log_err "Y7 OS requires at least 2GB RAM. Found: ${TOTAL_RAM_MB}MB"
    exit 1
  fi

  # Check minimum disk
  if [ "$FREE_DISK_GB" -lt 5 ]; then
    log_err "Y7 OS requires at least 5GB free disk. Found: ${FREE_DISK_GB}GB"
    exit 1
  fi

  # Check internet connectivity
  if ! curl -s --max-time 5 https://ollama.ai > /dev/null 2>&1; then
    log_warn "No internet connection detected. Some components may not install."
  else
    log_ok "Internet connection: OK"
  fi

  # Check package manager
  if command -v apt &>/dev/null; then
    PKG_MANAGER="apt"
    log_ok "Package manager: apt (Debian/Ubuntu)"
  elif command -v dnf &>/dev/null; then
    PKG_MANAGER="dnf"
    log_ok "Package manager: dnf (Fedora/RHEL)"
  elif command -v pacman &>/dev/null; then
    PKG_MANAGER="pacman"
    log_ok "Package manager: pacman (Arch)"
  else
    log_err "Unsupported package manager. Y7 OS currently supports apt, dnf, and pacman."
    exit 1
  fi

  log_ok "All preflight checks passed"
}

# â”€â”€ ZRAM Setup â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
setup_zram() {
  log_step "Configuring ZRAM (compressed RAM swap)..."

  # Calculate ZRAM size â€” half of total RAM
  ZRAM_SIZE_MB=$((TOTAL_RAM_MB / 2))
  ZRAM_SIZE="${ZRAM_SIZE_MB}M"

  if ! lsmod | grep -q zram; then
    sudo modprobe zram 2>/dev/null || { log_warn "ZRAM module not available, skipping"; return; }
  fi

  if [ -f /sys/block/zram0/comp_algorithm ]; then
    echo lz4 | sudo tee /sys/block/zram0/comp_algorithm > /dev/null 2>&1 || true
    echo "$ZRAM_SIZE" | sudo tee /sys/block/zram0/disksize > /dev/null 2>&1 || true
    sudo mkswap /dev/zram0 > /dev/null 2>&1 || true
    sudo swapon -p 100 /dev/zram0 > /dev/null 2>&1 || true
    log_ok "ZRAM configured: ${ZRAM_SIZE} compressed swap (lz4)"
  else
    log_warn "ZRAM device not found, skipping"
  fi
}

# â”€â”€ Install Dependencies â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
install_dependencies() {
  log_step "Installing dependencies..."

  DEPS="curl wget git python3 python3-pip"

  case "$PKG_MANAGER" in
    apt)
      sudo apt-get update -qq
      sudo apt-get install -y $DEPS docker.io 2>/dev/null || \
        sudo apt-get install -y $DEPS
      ;;
    dnf)
      sudo dnf install -y $DEPS docker
      ;;
    pacman)
      sudo pacman -Sy --noconfirm $DEPS docker
      ;;
  esac

  log_ok "Dependencies installed"
}

# â”€â”€ Install Ollama â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
install_ollama() {
  log_step "Installing Ollama..."

  if command -v ollama &>/dev/null; then
    log_info "Ollama already installed: $(ollama --version 2>/dev/null)"
    return
  fi

  curl -fsSL https://ollama.ai/install.sh | sh

  # Configure for low-resource devices
  if [ ! -f /etc/systemd/system/ollama.service.d/y7.conf ]; then
    sudo mkdir -p /etc/systemd/system/ollama.service.d/
    cat << EOF | sudo tee /etc/systemd/system/ollama.service.d/y7.conf > /dev/null
[Service]
Environment="OLLAMA_HOST=0.0.0.0:11434"
Environment="OLLAMA_MODELS=/ai/models"
Environment="OLLAMA_NUM_PARALLEL=1"
Environment="OLLAMA_MAX_LOADED_MODELS=1"
Environment="OLLAMA_KEEP_ALIVE=5m"
EOF
    sudo systemctl daemon-reload 2>/dev/null || true
    sudo systemctl restart ollama 2>/dev/null || true
  fi

  log_ok "Ollama installed"
}

# â”€â”€ Create AI Directory Structure â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
create_ai_structure() {
  log_step "Creating /ai/ directory structure..."

  sudo mkdir -p /ai/{models,prompts,outputs,logs}
  sudo chown -R $USER:$USER /ai/ 2>/dev/null || sudo chmod -R 777 /ai/

  # Create default prompt templates
  cat << 'EOF' > /ai/prompts/default-ar.txt
Ø£Ù†Øª Ù…Ø³Ø§Ø¹Ø¯ Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù…ÙÙŠØ¯. Ø£Ø¬Ø¨ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø¨Ø´ÙƒÙ„ ÙˆØ§Ø¶Ø­ ÙˆÙ…ÙˆØ¬Ø².
EOF

  cat << 'EOF' > /ai/prompts/default-en.txt
You are a helpful AI assistant. Answer clearly and concisely.
EOF

  log_ok "Created /ai/ structure"
}

# â”€â”€ Install y7 Tools â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
install_y7_tools() {
  log_step "Installing Y7 OS tools..."

  sudo mkdir -p /usr/local/bin

  # y7-status tool
  cat << 'TOOL' | sudo tee /usr/local/bin/y7-status > /dev/null
#!/bin/bash
# Y7 OS System Status Dashboard

BLUE='\033[0;34m'; GREEN='\033[0;32m'; YELLOW='\033[1;33m'
RED='\033[0;31m'; CYAN='\033[0;36m'; NC='\033[0m'; BOLD='\033[1m'

ram_used=$(free -m | awk '/^Mem:/{print $3}')
ram_total=$(free -m | awk '/^Mem:/{print $2}')
ram_pct=$((ram_used * 100 / ram_total))
cpu_pct=$(top -bn1 | grep "Cpu(s)" | awk '{print int($2)}')
disk_free=$(df -BG / | awk 'NR==2{print $4}')

bar() { local pct=$1 len=20 filled=$((pct*len/100))
  printf 'â–ˆ%.0s' $(seq 1 $filled 2>/dev/null || seq $filled)
  printf 'â–‘%.0s' $(seq 1 $((len-filled)) 2>/dev/null || seq $((len-filled))); }

ollama_status=$( (ollama ps &>/dev/null && echo "âœ… Running") || echo "â­• Stopped")
webui_status=$( (curl -s localhost:8080 &>/dev/null && echo "âœ… http://localhost:8080") || echo "â­• Not running")

echo ""
echo -e "${BLUE}${BOLD}â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—${NC}"
echo -e "${BLUE}${BOLD}â•‘         Y7 OS System Status              â•‘${NC}"
echo -e "${BLUE}${BOLD}â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£${NC}"
printf "${BLUE}${BOLD}â•‘${NC} RAM:  %3d%%  $(bar $ram_pct)  %dMB/%dMB ${BLUE}${BOLD}â•‘${NC}\n" $ram_pct $ram_used $ram_total
printf "${BLUE}${BOLD}â•‘${NC} CPU:  %3d%%  $(bar $cpu_pct)              ${BLUE}${BOLD}â•‘${NC}\n" $cpu_pct
echo -e "${BLUE}${BOLD}â•‘${NC} Disk: $disk_free free                              ${BLUE}${BOLD}â•‘${NC}"
echo -e "${BLUE}${BOLD}â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£${NC}"
echo -e "${BLUE}${BOLD}â•‘${NC} Ollama:  $ollama_status                       ${BLUE}${BOLD}â•‘${NC}"
echo -e "${BLUE}${BOLD}â•‘${NC} WebUI:   $webui_status    ${BLUE}${BOLD}â•‘${NC}"
echo -e "${BLUE}${BOLD}â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
echo ""
TOOL

  # y7-models tool
  cat << 'TOOL' | sudo tee /usr/local/bin/y7-models > /dev/null
#!/bin/bash
# Y7 OS Model Manager

CYAN='\033[0;36m'; GREEN='\033[0;32m'; YELLOW='\033[1;33m'
BLUE='\033[0;34m'; NC='\033[0m'; BOLD='\033[1m'

case "$1" in
  list)
    echo -e "\n${BOLD}Downloaded models:${NC}"
    ollama list
    ;;
  download)
    [ -z "$2" ] && echo "Usage: y7-models download <model>" && exit 1
    echo -e "${CYAN}Downloading $2...${NC}"
    ollama pull "$2"
    ;;
  switch)
    [ -z "$2" ] && echo "Usage: y7-models switch <model>" && exit 1
    echo -e "${GREEN}Switching to $2...${NC}"
    ollama run "$2"
    ;;
  delete)
    [ -z "$2" ] && echo "Usage: y7-models delete <model>" && exit 1
    ollama rm "$2" && echo -e "${GREEN}Deleted $2${NC}"
    ;;
  recommend)
    ram=$(free -m | awk '/^Mem:/{print $7}')
    echo -e "\n${BOLD}System: ${ram}MB free RAM${NC}\n"
    if   [ $ram -gt 12000 ]; then echo -e "ğŸ† ${GREEN}mistral:7b-q4_k_m${NC} â€” Best quality"
    elif [ $ram -gt 5000  ]; then echo -e "ğŸ† ${GREEN}phi3:mini${NC} â€” Best quality/size ratio"
    elif [ $ram -gt 3000  ]; then echo -e "ğŸ† ${GREEN}gemma:2b${NC} â€” Fast & efficient"
    else                          echo -e "ğŸ† ${GREEN}tinyllama${NC} â€” Ultra-low RAM"; fi
    echo ""
    ;;
  *)
    echo -e "\n${BOLD}y7-models â€” Y7 OS Model Manager${NC}"
    echo "  y7-models list              List downloaded models"
    echo "  y7-models download <model>  Download a model"
    echo "  y7-models switch <model>    Switch active model"
    echo "  y7-models delete <model>    Delete a model"
    echo "  y7-models recommend         Best model for your hardware"
    echo ""
    ;;
esac
TOOL

  # y7-ai launcher
  cat << 'TOOL' | sudo tee /usr/local/bin/y7-ai > /dev/null
#!/bin/bash
# Y7 OS â€” Intelligent AI Launcher

get_free_ram() { free -m | awk '/^Mem:/{print $7}'; }

launch_ai() {
  local ram=$(get_free_ram)
  local model=${1:-'phi3:mini'}

  if   [ $ram -gt 12000 ]; then echo "[Y7] Mode: Ollama High Performance"; ollama run "$model"
  elif [ $ram -gt 6000  ]; then echo "[Y7] Mode: Ollama Balanced"; OLLAMA_MAX_LOADED_MODELS=1 ollama run "$model"
  elif [ $ram -gt 3000  ]; then echo "[Y7] Mode: llama.cpp Low Resource"
    [ -f /opt/llama.cpp/llama-cli ] && /opt/llama.cpp/llama-cli -m /ai/models/phi3-mini.gguf -c 2048 -t $(nproc) || ollama run "$model"
  else echo "[Y7] Mode: Minimal"; ollama run tinyllama
  fi
}

launch_ai "$1"
TOOL

  sudo chmod +x /usr/local/bin/y7-status
  sudo chmod +x /usr/local/bin/y7-models
  sudo chmod +x /usr/local/bin/y7-ai

  log_ok "Y7 tools installed: y7-status, y7-models, y7-ai"
}

# â”€â”€ Download Starter Model â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
download_starter_model() {
  log_step "Downloading starter model: $RECOMMENDED_LABEL..."
  log_info "This may take a few minutes depending on your connection"

  # Start ollama service if not running
  ollama serve &>/dev/null &
  sleep 3

  ollama pull "$RECOMMENDED_MODEL" && log_ok "Model downloaded: $RECOMMENDED_MODEL" || \
    log_warn "Model download failed â€” run 'ollama pull $RECOMMENDED_MODEL' manually"
}

# â”€â”€ Install Open WebUI â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
install_webui() {
  log_step "Setting up Open WebUI..."

  if command -v docker &>/dev/null && docker info &>/dev/null; then
    docker run -d \
      -p 8080:8080 \
      -v /ai/webui:/app/backend/data \
      -e OLLAMA_BASE_URL=http://localhost:11434 \
      --name y7-webui \
      --restart unless-stopped \
      ghcr.io/open-webui/open-webui:main 2>/dev/null && \
      log_ok "Open WebUI running at http://localhost:8080" || \
      log_warn "Docker WebUI setup failed â€” try manually after install"
  else
    log_warn "Docker not available â€” Open WebUI skipped"
    log_info "Install Docker and run: y7-webui-start"
  fi
}

# â”€â”€ Final Summary â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
print_summary() {
  echo ""
  echo -e "${BLUE}${BOLD}  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
  echo -e "${GREEN}${BOLD}  ğŸ‰ Y7 OS Installation Complete!${NC}"
  echo -e "${BLUE}${BOLD}  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•${NC}"
  echo ""
  log_ok "AI model ready: $RECOMMENDED_MODEL"
  log_ok "Tools: y7-ai, y7-models, y7-status"
  log_ok "Models directory: /ai/models"
  echo ""
  echo -e "  ${BOLD}Quick Start:${NC}"
  echo -e "  ${CYAN}y7-ai${NC}               â†’ Start AI chat"
  echo -e "  ${CYAN}y7-status${NC}           â†’ System dashboard"
  echo -e "  ${CYAN}y7-models recommend${NC} â†’ Best model for your RAM"
  echo -e "  ${CYAN}http://localhost:8080${NC} â†’ Open WebUI (browser)"
  echo ""
  echo -e "  ${BOLD}GitHub:${NC} github.com/yahyasaqban-lab/y7os"
  echo -e "  ${BOLD}Report issues:${NC} github.com/yahyasaqban-lab/y7os/issues"
  echo ""
}

# â”€â”€ Main â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
main() {
  print_banner
  detect_hardware
  preflight_checks
  setup_zram
  install_dependencies
  install_ollama
  create_ai_structure
  install_y7_tools
  download_starter_model
  install_webui
  print_summary
}

main "$@"
